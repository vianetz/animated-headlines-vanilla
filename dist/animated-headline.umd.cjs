(function(r,a){typeof exports=="object"&&typeof module<"u"?a(exports):typeof define=="function"&&define.amd?define(["exports"],a):(r=typeof globalThis<"u"?globalThis:r||self,a(r.AnimatedHeadline={}))})(this,(function(r){"use strict";const a=(s,e,t,i=!1)=>s.dispatchEvent(new CustomEvent(`via-animated-headlines:${e}`,{bubbles:!0,cancelable:i,detail:t}));function u(s,e,t){let i=performance.now();requestAnimationFrame(function n(h){let l=(h-i)/t;l>1&&(l=1);let g=s(l);e(g),l<1&&requestAnimationFrame(n)})}class o extends HTMLElement{#e=!1;holdDelay=2500;wordSelector="b";connectedCallback(){this.holdDelay=this.hasAttribute("hold")?parseInt(this.getAttribute("hold")):this.holdDelay,this.resize(),window.matchMedia("(prefers-reduced-motion: reduce)").matches||this.start(),a(this,"animated-headlines","ready")}attributeChangedCallback(){this.resize()}resize(){let e=0;this.querySelectorAll(this.wordSelector).forEach(function(t){e=Math.max(t.offsetWidth,e)}),this.style.width=e.toString(),a(this,"resized",{width:e.toString()})}start(){this.#e=!1,this.runAfter(this.holdDelay,()=>this.next()),a(this,"started")}stop(){this.#e=!0,a(this,"stopped")}current(){return this.querySelector(this.wordSelector+":not([hidden])")??this.querySelector(this.wordSelector)}next(e=null){if(e=e??this.current(),e===null)return;const t=this.getNextWord(e);this.switchWord(e,t),this.runAfter(this.holdDelay,()=>this.next(t))}getNextWord(e){return e.nextElementSibling?e.nextElementSibling:e.parentNode.children[0]}switchWord(e,t){this.makeHidden(e),this.makeVisible(t),a(this,"word-replaced",{old:e,new:t})}makeVisible(e){e.removeAttribute("hidden")}makeHidden(e){e.setAttribute("hidden","")}runAfter(e,t){u(i=>i,i=>{if(this.#e)throw"execution aborted";i===1&&t()},e)}}customElements.define("via-animated-words-headline",o);class c extends o{lettersDelay=50;letterClassName="letter";connectedCallback(){super.connectedCallback(),this.lettersDelay=this.hasAttribute("delay")?parseInt(this.getAttribute("delay")):this.lettersDelay,this.querySelectorAll(this.wordSelector).forEach(this.splitIntoSingleLetters,this)}next(e=null){if(e=e??this.current(),e===null)return;const t=this.getNextWord(e),i=e.querySelectorAll("."+this.letterClassName).length>=t.querySelectorAll("."+this.letterClassName).length;this.hideLetter(e.querySelector("."+this.letterClassName),e,i),this.showLetter(t.querySelector("."+this.letterClassName),t,!i),this.switchWord(e,t)}hideLetter(e,t,i){this.hideOrShowLetter(e,t,i,!0)}showLetter(e,t,i){this.hideOrShowLetter(e,t,i,!1)}hideOrShowLetter(e,t,i=!0,n=!1){n?this.makeHidden(e):this.makeVisible(e),e.nextElementSibling?this.runAfter(this.lettersDelay,()=>this.hideOrShowLetter(e.nextElementSibling,t,i,n)):i&&this.runAfter(this.holdDelay,()=>this.next(n?this.getNextWord(t):t))}splitIntoSingleLetters(e){const t=[];for(const i of e.childNodes)if(i.nodeType===Node.TEXT_NODE){const n=i.textContent.split("");for(let h in n){const l=document.createElement("span");l.innerHTML=n[h],t.push(l)}}else i.nodeType===Node.ELEMENT_NODE?t.push(i):console.warn("unsupported child node:",i);t.forEach(i=>{i.classList.add(this.letterClassName),e.hasAttribute("hidden")&&i.setAttribute("hidden","")}),e.innerHTML=t.map(i=>i.outerHTML).join(""),e.style.opacity="1"}}customElements.define("via-animated-letters-headline",c);class m extends o{revealDelay=600;connectedCallback(){super.connectedCallback(),this.revealDelay=this.hasAttribute("delay")?parseInt(this.getAttribute("delay")):this.revealDelay}resize(){this.style.width=String(this.offsetWidth+10)}showWord(e){let t=e.parentNode.animate([{width:"2px"},{width:e.offsetWidth+"px"}],{duration:this.revealDelay});t.onfinish=i=>this.runAfter(this.holdDelay,()=>this.next(e))}next(e=null){if(e=e??this.current(),e===null)return;const t=this.getNextWord(e);let i=e.parentNode.animate([{width:e.offsetWidth+"px"},{width:"2px"}],{duration:this.revealDelay});i.onfinish=n=>{this.switchWord(e,t),this.showWord(t)}}}customElements.define("via-animated-clip-headline",m);class f extends o{#e="is-loading";barDelay=500;connectedCallback(){super.connectedCallback(),this.barDelay=this.hasAttribute("delay")?parseInt(this.getAttribute("delay")):this.barDelay,this.runAfter(this.barDelay,()=>this.classList.add(this.#e))}next(e=null){super.next(e),e=e??this.current(),e!==null&&(e.parentNode.classList.remove(this.#e),this.runAfter(this.barDelay,()=>e.parentNode.classList.add(this.#e)))}}customElements.define("via-animated-loading-headline",f);class p extends c{#e="waiting";#t="selected";selectionDuration=500;connectedCallback(){super.connectedCallback(),this.selectionDuration=this.hasAttribute("selection")?parseInt(this.getAttribute("selection")):this.selectionDuration}resize(){}showWord(e){const t=this.current();this.showLetter(e.querySelector("."+this.letterClassName),e),this.makeVisible(e),a(this,"word-replaced",{old:t,new:e})}next(e=null){if(e=e??this.current(),e===null)return;const t=this.getNextWord(e),i=e.parentNode;i.classList.add(this.#t),i.classList.remove(this.#e),this.runAfter(this.selectionDuration,()=>{i.classList.remove(this.#t),this.makeHidden(e),e.querySelectorAll("."+this.letterClassName).forEach(n=>this.makeHidden(n))}),this.runAfter(this.selectionDuration*2,()=>this.showWord(t))}showLetter(e,t,i=!0){super.showLetter(e,t,i),e.nextElementSibling||this.runAfter(200,()=>t.parentNode.classList.add(this.#e))}}customElements.define("via-animated-type-headline",p);var d=(s=>(s.Clip="clip",s.LoadingBar="loading-bar",s.Push="push",s.Rotate1="rotate-1",s.Rotate2="rotate-2",s.Rotate3="rotate-3",s.Scale="scale",s.Slide="slide",s.Type="type",s.Zoom="zoom",s))(d||{});function b(s,e={}){let t;switch(s){case"clip":t=document.createElement("via-animated-clip-headline");break;case"loading-bar":t=document.createElement("via-animated-loading-headline");break;case"push":case"slide":case"rotate-1":case"zoom":t=document.createElement("via-animated-words-headline");break;case"scale":case"rotate-2":case"rotate-3":t=document.createElement("via-animated-letters-headline");break;case"type":t=document.createElement("via-animated-type-headline");break;default:throw"invalid animation type "+s+" (must be one of "+Object.values(d)+")"}for(const[i,n]of Object.entries(e))t.setAttribute(i,n??"");return t}class y extends HTMLElement{static get observedAttributes(){return["animation","hold","delay"]}connectedCallback(){this.render()}attributeChangedCallback(){this.render()}render(){const e=this.getAttribute("animation"),t={};for(const n of this.attributes)n.name!=="animation"&&(t[n.name]=n.value);const i=b(e,t);Array.from(this.children).forEach(n=>{n.tagName?.startsWith("VIA-ANIMATED-")?n.childNodes.forEach(h=>i.appendChild(h.cloneNode(!0))):i.appendChild(n.cloneNode(!0))}),this.innerHTML="",this.appendChild(i)}}customElements.define("via-animated-headline",y);r.AnimationType=d,Object.defineProperty(r,Symbol.toStringTag,{value:"Module"})}));
/**!
 * Plain Vanilla JavaScript Animated Headline Component
 *
 * @author Geoff Selby
 * @author Christoph Massmann <cm@vianetz.com>
 * @license https://opensource.org/licenses/MIT MIT License
 */
